!function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var i=n(1),r=o(i),u=n(2),s=o(u),a=n(4),c=o(a),l=n(8),f=o(l);!function(t){if(!t)throw new Error("angular not defined");var e=t.module("bg.engine",[]);e.directive("bgEntity",r.default),e.directive("bgScene",s.default),e.value("bgUtils",f.default),e.factory("bgMovement",c.default)}(window.angular)},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return{restrict:"E",scope:{size:"<",position:"=",texture:"<",movement:"<",name:"@",collision:"&"},require:"^^bgScene",link:function(t,e,n,o){var i={updateMovement:function(e){if(t.movement){var n=null,o=function(e){return"undefined"==typeof e?t.position:void(n={entity:i,oldPosition:t.position,newPosition:e})};t.movement.update(o),n&&e.push(n)}},setPosition:function(e){t.position=e},fireCollision:function(e,n){t.collision({$event:e,$actions:n})}};o.addEntity(i),t.$watchCollection("size",function(t){i.size=t,e.css("width",t[0]+"px"),e.css("height",t[1]+"px")}),t.$watchCollection("position",function(t){i.position=t,e.css("left",t[0]+"px"),e.css("top",t[1]+"px")}),t.$watch("texture",function(t){i.texture=t,e.css("background",t)}),t.$watch("name",function(t){i.name=t}),t.$watch("movement",function(t){i.movement=t}),t.$on("$destroy",function(){o.removeEntity(i)})}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3);e.default=["$rootScope","$window",function(t,e){return{restrict:"E",scope:!0,controller:["$scope","$element","$attrs",function(t,e,n){var i=this;i.entities={},this.tick=function(){var t=[];for(var e in i.entities)i.entities[e].updateMovement(t);for(;t.length;){var n=[];t.forEach(function(t){var e=t.entity;t.entity.setPosition(t.newPosition);for(var n in i.entities){var r=i.entities[n];if(e!==r){var u={position:[r.position[0]-(t.newPosition[0]+e.size[0]),r.position[1]-(t.newPosition[1]+e.size[1])],size:[e.size[0]+r.size[0],e.size[1]+r.size[1]]};if(u.position[0]<=0&&u.position[0]+u.size[0]>=0&&u.position[1]<=0&&u.position[1]+u.size[1]>=0){var s,a,c,l,f;!function(){s=Math.abs(u.position[0]),a=[u.position[0],0],Math.abs(u.position[0]+u.size[0])<s&&(s=Math.abs(u.position[0]+u.size[0]),a=[u.position[0]+u.size[0],0]),Math.abs(u.position[1]+u.size[1])<s&&(s=Math.abs(u.position[1]+u.size[1]),a=[0,u.position[1]+u.size[1]]),Math.abs(u.position[1])<s&&(s=Math.abs(u.position[1]),a=[0,u.position[1]]);var n=[t.newPosition[0]+a[0],t.newPosition[1]+a[1]],i=[t.newPosition[0]-t.oldPosition[0],t.newPosition[1]-t.oldPosition[1]],p=[n[0]-t.oldPosition[0],n[1]-t.oldPosition[1]],d=[i[0]-p[0],i[1]-p[1]],y=Math.abs(u.position[0])<Math.abs(u.position[1])?[-1,1]:[1,-1];c=!1,l={bounce:function(){[n[0]+d[0]*y[0],n[1]+d[1]*y[1]];if(e.movement){var t=e.movement.velocity;t&&(e.movement.velocity=[t[0]*y[0],t[1]*y[1]])}e.setPosition(n),c=!0}},f=new o.CollisionEvent(new o.EntityTarget(e),new o.EntityTarget(r)),e.fireCollision(f,l)}()}}}var p=function(t,e,n,i,r){var u=new o.CollisionEvent(new o.EntityTarget(e),new o.WallTarget(t)),s={bounce:function(){[n[0]+i[0]*r[0],n[1]+i[1]*r[1]];if(e.movement){var t=e.movement.velocity;t&&(e.movement.velocity=[t[0]*r[0],t[1]*r[1]])}e.setPosition(n),c=!0}};e.fireCollision(u,s)};if(t.newPosition[0]<0){var d=[0,t.newPosition[1]],y=[t.newPosition[0]-t.oldPosition[0],t.newPosition[1]-t.oldPosition[1]],v=[d[0]-t.oldPosition[0],d[1]-t.oldPosition[1]],b=[y[0]-v[0],y[1]-v[1]];p("left",e,d,b,[-1,1])}else if(t.newPosition[0]+e.size[0]>i.size[0]){var h=[i.size[0]-e.size[0],t.newPosition[1]],m=[t.newPosition[0]-t.oldPosition[0],t.newPosition[1]-t.oldPosition[1]],w=[h[0]-t.oldPosition[0],h[1]-t.oldPosition[1]],P=[m[0]-w[0],m[1]-w[1]];p("right",e,h,P,[-1,1])}else if(t.newPosition[1]<0){var g=[t.newPosition[0],0],_=[t.newPosition[0]-t.oldPosition[0],t.newPosition[1]-t.oldPosition[1]],k=[g[0]-t.oldPosition[0],g[1]-t.oldPosition[1]],O=[_[0]-k[0],_[1]-k[1]];p("top",e,g,O,[1,-1])}else if(t.newPosition[1]+e.size[1]>i.size[1]){var M=[t.newPosition[0],i.size[1]-e.size[1]],j=[t.newPosition[0]-t.oldPosition[0],t.newPosition[1]-t.oldPosition[1]],z=[M[0]-t.oldPosition[0],M[1]-t.oldPosition[1]],E=[j[0]-z[0],j[1]-z[1]];p("bottom",e,M,E,[1,-1])}}),t=n}};var r=0,u=function(t){return"entityId"in t||(t.entityId=r++),t.entityId};this.addEntity=function(t){i.entities[u(t)]=t},this.removeEntity=function(t){delete i.entities[t.entityId]}}],link:function(n,o,i,r){n.$watch(i.size,function(t){r.size=t,o.css("width",t[0]+"px"),o.css("height",t[1]+"px")});var u=function n(){r.tick(),t.$digest(),r.animRequest=e.requestAnimationFrame(n)};r.animRequest=e.requestAnimationFrame(u),n.$on("$destroy",function(){e.cancelAnimationFrame(r.animRequest)})}}}]},function(t,e){"use strict";function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=e.CollisionTarget=function t(){i(this,t)},s=Symbol.entity,a=(e.EntityTarget=function(t){function e(t){i(this,e);var o=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o[s]=t,o}return o(e,t),r(e,[{key:"name",get:function(){return this[s].name}},{key:"type",get:function(){return"entity"}}]),e}(u),Symbol("name")),c=(e.WallTarget=function(t){function e(t){i(this,e);var o=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o[a]=t,o}return o(e,t),r(e,[{key:"type",get:function(){return"wall"}},{key:"name",get:function(){return this[a]}}]),e}(u),Symbol("source")),l=Symbol("target");e.CollisionEvent=function(){function t(e,n){i(this,t),this[c]=e,this[l]=n}return r(t,[{key:"source",get:function(){return this[c]}},{key:"target",get:function(){return this[l]}}]),t}()},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return{custom:function(){return new s.default},automatic:function(){return new r.default}}};var i=n(5),r=o(i),u=n(7),s=o(u)},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(6),c=o(a),l=Symbol("velocity"),f=function(t){function e(){i(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t[l]=[0,0],t}return u(e,t),s(e,[{key:"update",value:function(t){var e=t();0===this[l][0]&&0===this[l][1]||t([e[0]+this[l][0],e[1]+this[l][1]])}},{key:"velocity",set:function(t){this[l]=t},get:function(){return this[l]}}]),e}(c.default);e.default=f},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=function(){function t(){n(this,t)}return o(t,[{key:"update",value:function(t){}}]),t}();e.default=i},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(6),c=o(a),l=Symbol("position"),f=function(t){function e(){return i(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return u(e,t),s(e,[{key:"update",value:function(t){angular.equals(t(),this[l])||t(this[l])}},{key:"position",set:function(t){this[l]=t}}]),e}(c.default);e.default=f},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=function(){function t(){n(this,t)}return o(t,null,[{key:"polar2rectangular",value:function(t,e){return[t*Math.cos(e),t*Math.sin(e)]}},{key:"randomBallVelocity",value:function(t,e){return this.polar2rectangular(t+Math.random()*(e-t),Math.random()*Math.PI)}},{key:"randomInt",value:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}},{key:"randomColor",value:function(){var e=["red","green","blue","yellow","orange"];return e[t.randomInt(0,e.length-1)]}},{key:"createBrickField",value:function(t){var e=angular.extend({texture:function(t,e,n,o,i,r){return"orange"},top:0,left:0,bottom:0,right:0,marginX:1,marginY:1,bricksX:10,bricksY:10},t),n=(e.width-(e.left+e.right))/e.bricksX,o=(e.height-(e.top+e.bottom))/e.bricksY,i=n-e.marginX,r=o-e.marginY;return new Array(e.bricksX*e.bricksY).fill(null).map(function(t,u){var s=u%e.bricksX,a=Math.floor(u/e.bricksX),c=[e.left+e.marginX+s*n,e.top+e.marginY+a*o];return{position:c,size:[i,r],texture:e.texture(s,a,c[0],c[1],i,r),name:"brick"+u,alive:!0}})}}]),t}();e.default=i}]);
//# sourceMappingURL=engine.min.js.map